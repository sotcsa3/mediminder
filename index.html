<!DOCTYPE html>
<html lang="hu">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MediMinder ‚Äì Gy√≥gyszer √©s Orvosi Tal√°lkoz√≥ Kezel≈ë</title>
    <meta name="description" content="MediMinder ‚Äì Egyszer≈± gy√≥gyszerkezel≈ë √©s orvosi tal√°lkoz√≥ alkalmaz√°s id≈ëseknek">

    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366F1">

    <!-- Apple PWA support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="MediMinder">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512.png">

    <!-- OpenGraph / Social sharing -->
    <meta property="og:title" content="MediMinder ‚Äì Gy√≥gyszerkezel≈ë">
    <meta property="og:description" content="Egyszer≈± gy√≥gyszerkezel≈ë √©s orvosi tal√°lkoz√≥ alkalmaz√°s id≈ëseknek">
    <meta property="og:type" content="website">
    <meta property="og:image" content="icons/icon-512.png">

    <!-- Fonts & Styles -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- ============================================ -->
    <!-- SPLASH SCREEN                                 -->
    <!-- ============================================ -->
    <div id="splash-screen" class="splash-screen">
        <div class="splash-content">
            <div class="splash-icon">üíä</div>
            <h1 class="splash-title">MediMinder</h1>
            <p class="splash-subtitle">Az √ñn eg√©szs√©g√ºgyi asszisztense</p>
            <div class="splash-loader">
                <div class="splash-loader-bar"></div>
            </div>
            <p class="splash-version" id="splash-version"></p>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- MAIN APP                                      -->
    <!-- ============================================ -->
    <div id="app" class="app hidden">
        <!-- HEADER -->
        <header class="app-header">
            <div class="header-left">
                <div class="header-greeting" id="header-greeting"></div>
                <div class="header-date" id="header-date"></div>
            </div>
            <div class="header-right">
                <button class="header-bell-btn" id="btn-notifications" aria-label="√ârtes√≠t√©sek">
                    <span class="bell-icon" id="bell-icon">üîî</span>
                </button>
                <button class="header-account-btn" id="btn-account" aria-label="Fi√≥k">
                    <span class="account-icon" id="account-icon">üë§</span>
                </button>
            </div>
        </header>

        <!-- PAGE CONTAINER -->
        <main class="page-container">

            <!-- ======= DASHBOARD ======= -->
            <section id="page-dashboard" class="page active">
                <div class="section-card">
                    <div class="section-header">
                        <span class="section-icon">üíä</span>
                        <h2>Mai gy√≥gyszerek</h2>
                    </div>
                    <div id="dashboard-meds" class="dashboard-meds-list">
                        <!-- Dynamic content -->
                    </div>
                    <div id="dashboard-meds-empty" class="empty-state hidden">
                        <span class="empty-icon">üéâ</span>
                        <p>Nincs mai gy√≥gyszer bejegyezve</p>
                    </div>
                </div>

                <div class="section-card">
                    <div class="section-header">
                        <span class="section-icon">ü©∫</span>
                        <h2>K√∂vetkez≈ë vizit</h2>
                    </div>
                    <div id="dashboard-appointment" class="dashboard-appointment">
                        <!-- Dynamic content -->
                    </div>
                    <div id="dashboard-appointment-empty" class="empty-state hidden">
                        <span class="empty-icon">üìÖ</span>
                        <p>Nincs k√∂zelg≈ë orvosi tal√°lkoz√≥</p>
                    </div>
                </div>

                <div class="stats-row">
                    <div class="stat-card stat-taken">
                        <div class="stat-number" id="stat-taken">0</div>
                        <div class="stat-label">Bev√©ve ma</div>
                    </div>
                    <div class="stat-card stat-remaining">
                        <div class="stat-number" id="stat-remaining">0</div>
                        <div class="stat-label">M√©g h√°tra</div>
                    </div>
                    <div class="stat-card stat-appointments">
                        <div class="stat-number" id="stat-appointments">0</div>
                        <div class="stat-label">Vizit a h√©ten</div>
                    </div>
                </div>
            </section>

            <!-- ======= MEDICATIONS ======= -->
            <section id="page-medications" class="page">
                <h1 class="page-title">üíä Gy√≥gyszereim</h1>

                <!-- Day Selector -->
                <div class="day-selector">
                    <button class="day-btn active" data-day="today">Ma</button>
                    <button class="day-btn" data-day="all">√ñsszes</button>
                </div>

                <div id="medications-list" class="medications-list">
                    <!-- Dynamic content -->
                </div>

                <div id="medications-empty" class="empty-state hidden">
                    <span class="empty-icon">üíä</span>
                    <p>M√©g nincs gy√≥gyszer felv√©ve</p>
                    <p class="empty-hint">Nyomja meg az al√°bbi gombot az els≈ë gy√≥gyszer hozz√°ad√°s√°hoz</p>
                </div>

                <button class="add-button" id="btn-add-med" aria-label="√öj gy√≥gyszer hozz√°ad√°sa">
                    <span class="add-button-icon">‚ûï</span>
                    <span>√öj gy√≥gyszer hozz√°ad√°sa</span>
                </button>
            </section>

            <!-- ======= APPOINTMENTS ======= -->
            <section id="page-appointments" class="page">
                <h1 class="page-title">ü©∫ Orvosi tal√°lkoz√≥k</h1>

                <div class="appointments-section">
                    <h3 class="appointments-section-title">üìÖ K√∂zelg≈ë</h3>
                    <div id="appointments-upcoming" class="appointments-list">
                        <!-- Dynamic content -->
                    </div>
                    <div id="appointments-upcoming-empty" class="empty-state hidden">
                        <span class="empty-icon">üóìÔ∏è</span>
                        <p>Nincs k√∂zelg≈ë tal√°lkoz√≥</p>
                    </div>
                </div>

                <div class="appointments-section">
                    <h3 class="appointments-section-title">üìã Kor√°bbi</h3>
                    <div id="appointments-past" class="appointments-list">
                        <!-- Dynamic content -->
                    </div>
                    <div id="appointments-past-empty" class="empty-state hidden">
                        <p class="empty-small">M√©g nincs kor√°bbi tal√°lkoz√≥</p>
                    </div>
                </div>

                <button class="add-button" id="btn-add-appointment" aria-label="√öj tal√°lkoz√≥ hozz√°ad√°sa">
                    <span class="add-button-icon">‚ûï</span>
                    <span>√öj tal√°lkoz√≥ hozz√°ad√°sa</span>
                </button>
            </section>
        </main>

        <!-- BOTTOM NAV -->
        <nav class="bottom-nav" role="navigation" aria-label="F≈ë navig√°ci√≥">
            <button class="nav-item active" data-page="dashboard" id="nav-dashboard">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">F≈ëoldal</span>
            </button>
            <button class="nav-item" data-page="medications" id="nav-medications">
                <span class="nav-icon">üíä</span>
                <span class="nav-label">Gy√≥gyszerek</span>
            </button>
            <button class="nav-item" data-page="appointments" id="nav-appointments">
                <span class="nav-icon">ü©∫</span>
                <span class="nav-label">Orvos</span>
            </button>
        </nav>
        <div class="app-version" id="app-version"></div>

        <!-- ============================================ -->
        <!-- MODAL: ADD/EDIT MEDICATION                    -->
        <!-- ============================================ -->
        <div id="modal-medication" class="modal-overlay hidden" role="dialog" aria-modal="true"
            aria-label="Gy√≥gyszer hozz√°ad√°sa">
            <div class="modal">
                <div class="modal-header">
                    <h2 id="modal-med-title">√öj gy√≥gyszer</h2>
                    <button class="modal-close" id="modal-med-close" aria-label="Bez√°r√°s">&times;</button>
                </div>
                <form id="form-medication" class="modal-form">
                    <input type="hidden" id="med-id">
                    <div class="form-group">
                        <label for="med-name">Gy√≥gyszer neve *</label>
                        <input type="text" id="med-name" placeholder="pl. Metformin" required autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="med-dosage">D√≥zis *</label>
                        <input type="text" id="med-dosage" placeholder="pl. 500mg" required>
                    </div>
                    <div class="form-group">
                        <label for="med-frequency">Gyakoris√°g</label>
                        <select id="med-frequency">
                            <option value="daily1">Naponta 1x</option>
                            <option value="daily2">Naponta 2x</option>
                            <option value="daily3">Naponta 3x</option>
                            <option value="weekly">Hetente</option>
                            <option value="asneeded">Sz√ºks√©g szerint</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Bev√©teli id≈ëpontok</label>
                        <div class="time-inputs" id="time-inputs">
                            <input type="time" class="time-input" value="08:00">
                        </div>
                        <button type="button" class="btn-add-time" id="btn-add-time">+ Id≈ëpont</button>
                    </div>
                    <div class="form-group">
                        <label for="med-notes">Megjegyz√©s</label>
                        <input type="text" id="med-notes" placeholder="pl. √âtkez√©s ut√°n">
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-cancel" id="btn-med-cancel">M√©gse</button>
                        <button type="submit" class="btn btn-primary">Ment√©s</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- MODAL: ADD/EDIT APPOINTMENT                   -->
        <!-- ============================================ -->
        <div id="modal-appointment" class="modal-overlay hidden" role="dialog" aria-modal="true"
            aria-label="Tal√°lkoz√≥ hozz√°ad√°sa">
            <div class="modal">
                <div class="modal-header">
                    <h2 id="modal-appt-title">√öj tal√°lkoz√≥</h2>
                    <button class="modal-close" id="modal-appt-close" aria-label="Bez√°r√°s">&times;</button>
                </div>
                <form id="form-appointment" class="modal-form">
                    <input type="hidden" id="appt-id">
                    <div class="form-group">
                        <label for="appt-doctor">Orvos neve *</label>
                        <input type="text" id="appt-doctor" placeholder="pl. Dr. Kov√°cs P√©ter" required
                            autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="appt-specialty">Szakter√ºlet</label>
                        <select id="appt-specialty">
                            <option value="">V√°lasszon...</option>
                            <option value="Belgy√≥gy√°szat">Belgy√≥gy√°szat</option>
                            <option value="Kardiol√≥gia">Kardiol√≥gia</option>
                            <option value="Szem√©szet">Szem√©szet</option>
                            <option value="Ortop√©dia">Ortop√©dia</option>
                            <option value="Neurol√≥gia">Neurol√≥gia</option>
                            <option value="B≈ërgy√≥gy√°szat">B≈ërgy√≥gy√°szat</option>
                            <option value="Fog√°szat">Fog√°szat</option>
                            <option value="Urol√≥gia">Urol√≥gia</option>
                            <option value="N≈ëgy√≥gy√°szat">N≈ëgy√≥gy√°szat</option>
                            <option value="F√ºl-orr-g√©g√©szet">F√ºl-orr-g√©g√©szet</option>
                            <option value="H√°ziorvos">H√°ziorvos</option>
                            <option value="Egy√©b">Egy√©b</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="appt-date">D√°tum *</label>
                            <input type="date" id="appt-date" required>
                        </div>
                        <div class="form-group">
                            <label for="appt-time">Id≈ëpont *</label>
                            <input type="time" id="appt-time" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="appt-location">Helysz√≠n</label>
                        <input type="text" id="appt-location" placeholder="pl. Klinika, 3. emelet">
                    </div>
                    <div class="form-group">
                        <label for="appt-notes">Megjegyz√©s</label>
                        <textarea id="appt-notes" rows="2" placeholder="pl. V√©rv√©tel eredm√©ny√©t vinni"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-cancel" id="btn-appt-cancel">M√©gse</button>
                        <button type="submit" class="btn btn-primary">Ment√©s</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- TOAST NOTIFICATION                            -->
        <!-- ============================================ -->
        <div id="toast" class="toast hidden">
            <span id="toast-message"></span>
        </div>

        <!-- ============================================ -->
        <!-- CONFIRM DIALOG                                -->
        <!-- ============================================ -->
        <div id="modal-confirm" class="modal-overlay hidden" role="dialog" aria-modal="true">
            <div class="modal modal-confirm">
                <div class="confirm-icon" id="confirm-icon">‚ö†Ô∏è</div>
                <h3 id="confirm-title">Biztosan t√∂rli?</h3>
                <p id="confirm-message">Ez a m≈±velet nem vonhat√≥ vissza.</p>
                <div class="modal-actions">
                    <button class="btn btn-cancel" id="btn-confirm-no">M√©gse</button>
                    <button class="btn btn-danger" id="btn-confirm-yes">T√∂rl√©s</button>
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- MODAL: AUTH (LOGIN / REGISTER)                -->
        <!-- ============================================ -->
        <div id="modal-auth" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-label="Bejelentkez√©s">
            <div class="modal">
                <div class="modal-header">
                    <h2 id="modal-auth-title">Bejelentkez√©s</h2>
                    <button class="modal-close" id="modal-auth-close" aria-label="Bez√°r√°s">&times;</button>
                </div>
                <form id="form-auth" class="modal-form">
                    <div class="form-group">
                        <label for="auth-email">Email c√≠m *</label>
                        <input type="email" id="auth-email" placeholder="pelda@email.com" required autocomplete="email">
                    </div>
                    <div class="form-group">
                        <label for="auth-password">Jelsz√≥ *</label>
                        <input type="password" id="auth-password" placeholder="Minimum 6 karakter" required
                            minlength="6" autocomplete="current-password">
                    </div>
                    <div id="auth-error" class="auth-error hidden"></div>
                    <div class="modal-actions">
                        <button type="submit" class="btn btn-primary" id="btn-auth-submit">Bejelentkez√©s</button>
                    </div>
                    <div class="auth-switch">
                        <span id="auth-switch-text">M√©g nincs fi√≥kja?</span>
                        <button type="button" class="auth-switch-btn" id="btn-auth-switch">Regisztr√°ci√≥</button>
                    </div>
                    <div class="auth-divider">
                        <span>vagy</span>
                    </div>
                    <button type="button" class="btn-google-signin" id="btn-google-signin">
                        <svg viewBox="0 0 24 24" width="22" height="22">
                            <path
                                d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 01-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z"
                                fill="#4285F4" />
                            <path
                                d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                                fill="#34A853" />
                            <path
                                d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
                                fill="#FBBC05" />
                            <path
                                d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
                                fill="#EA4335" />
                        </svg>
                        Bejelentkez√©s Google fi√≥kkal
                    </button>
                </form>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- MODAL: ACCOUNT (Logged in user)               -->
        <!-- ============================================ -->
        <div id="modal-account" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-label="Fi√≥k">
            <div class="modal modal-confirm">
                <div class="confirm-icon">üë§</div>
                <h3 id="account-user-name">Felhaszn√°l√≥</h3>
                <p id="account-user-email" class="account-email"></p>
                <div class="auth-status-badge" id="auth-status-badge">
                    <span class="status-dot"></span>
                    <span>Szinkroniz√°lva</span>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-cancel" id="btn-account-close">Bez√°r√°s</button>
                    <button class="btn btn-danger" id="btn-logout">Kijelentkez√©s</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>

    <!-- App scripts (order matters!) -->
    <script src="firebase-config.js"></script>
    <script src="firebase-db.js"></script>
    <script src="app.js"></script>

    <script>
        // Register Service Worker for offline support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then((reg) => console.log('[SW] Registered:', reg.scope))
                    .catch((err) => console.warn('[SW] Registration failed:', err));
            });
        }
    </script>
</body>

</html>